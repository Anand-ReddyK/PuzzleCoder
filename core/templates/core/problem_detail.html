{% extends "core/base.html" %}
{% load tagger %}

{% block extra_head %}
    <script src="https://cdn.jsdelivr.net/npm/split.js/dist/split.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-ui/1.12.1/jquery-ui.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-ui/1.12.1/jquery-ui.min.js"></script>
{% endblock %}

{% block content %}
<div class="container mx-auto p-4">
    <h1 class="text-3xl font-bold text-center mb-6 text-white">{{ problem_data.title }}</h1>
    <div id="split-container" class="flex h-screen">
        <!-- Problem Details -->
        <div id="problem-details" class="bg-gray-800 text-gray-200 p-6 overflow-auto w-1/2">
            <h2 class="text-xl font-semibold mb-4">Problem Description</h2>
            <p class="mb-4">{{ problem_data.description.problem }}</p>
            
            <h3 class="text-lg font-semibold mb-2">Examples</h3>
            <ul class="list-disc list-inside mb-4">
                {% for example in problem_data.description.examples %}
                <li class="mb-2">
                    <strong>Input:</strong> {{ example.input }}<br>
                    <strong>Output:</strong> {{ example.output }}<br>
                    <em>{{ example.description }}</em>
                </li>
                {% endfor %}
            </ul>
            
            <h3 class="text-lg font-semibold mb-2">Function Description</h3>
            <p class="mb-2"><strong>Inputs:</strong></p>
            <ul class="list-disc list-inside mb-4">
                {% for input in problem_data.description.function_description.inputs %}
                <li>
                    {{ input.name }} ({{ input.type }}): {{ input.description }}
                </li>
                {% endfor %}
            </ul>
            <p class="mb-4"><strong>Returns:</strong> {{ problem_data.description.function_description.returns.type }}: {{ problem_data.description.function_description.returns.description }}</p>
            
            <h3 class="text-lg font-semibold mb-2">Input Format</h3>
            <p class="mb-4">{{ problem_data.description.input_format }}</p>
            
            <h3 class="text-lg font-semibold mb-2">Constraints</h3>
            <ul class="list-disc list-inside mb-4">
                {% for constraint in problem_data.description.constraints %}
                <li>{{ constraint.constraint }}</li>
                {% endfor %}
            </ul>
            
            <h3 class="text-lg font-semibold mb-2">Sample Input and Output</h3>
            <ul class="list-disc list-inside mb-4">
                {% for sample in problem_data.description.sample_input_output %}
                <li>
                    <strong>Input:</strong> {{ sample.input }}<br>
                    <strong>Expected Output:</strong> {{ sample.expected_output }}
                </li>
                {% endfor %}
            </ul>
            
            <h3 class="text-lg font-semibold mb-2">Test Cases</h3>
            <ul id="test-cases" class="list-disc list-inside mb-4">
                {% for test_case in problem_data.description.test_cases %}
                <li class="mb-2">
                    <strong>Input:</strong> {{ test_case.input }}<br>
                    <strong>Expected Output:</strong> {{ test_case.expected_output }}
                </li>
                {% endfor %}
            </ul>
        </div>

        <!-- Editor and Test Cases -->
        <div id="editor-container" class="bg-gray-900 text-gray-200 p-6 overflow-auto w-1/2">
            <div class="mb-4">
                <label for="language" class="block text-sm font-medium">Select Language</label>
                <select id="language" name="language" class="block w-full mt-1 p-2 bg-gray-800 text-gray-200 rounded-md border border-gray-700">
                    <option value="python">Python</option>
                    <option value="javascript">JavaScript</option>
                    <option value="java">Java</option>
                    <!-- Add more options as needed -->
                </select>
            </div>
            <div id="editor" class="mb-4">
                <label for="editor-textarea" class="block text-sm font-medium">Your Solution</label>
                <textarea id="editor-textarea" name="editor" rows="10" class="block w-full mt-1 p-2 bg-gray-800 text-gray-200 rounded-md border border-gray-700"></textarea>
            </div>
            <div class="flex justify-between mb-4">
                <button id="run-button" class="bg-green-500 text-white px-4 py-2 rounded-md">Run Code</button>
                <button id="submit-button" class="bg-blue-500 text-white px-4 py-2 rounded-md">Submit Code</button>
            </div>
            <div id="terminal" class="bg-gray-800 p-4 rounded-lg text-gray-200">
                <h3 class="text-lg font-semibold mb-2">Terminal</h3>
                <div id="terminal-content" class="whitespace-pre-wrap"></div>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        // Initialize Split.js
        Split(['#problem-details', '#editor-container'], {
            sizes: [50, 50],
            minSize: 200,
            gutterSize: 10,
            cursor: 'col-resize',
        });

        // Make sections draggable
        $("#problem-details, #editor-container").draggable({
            handle: ".handle"
        });

        // Placeholder for run button functionality
        document.getElementById('run-button').addEventListener('click', function() {
            const code = document.getElementById('editor-textarea').value;
            const language = document.getElementById('language').value;
            const terminalContent = document.getElementById('terminal-content');
            // Call your backend API to run the code and get the output
            // For now, we just display a placeholder message
            terminalContent.textContent = `Running code in ${language}...\n\nYour Output: \nExpected Output: \n`;
        });

        // Placeholder for submit button functionality
        document.getElementById('submit-button').addEventListener('click', function() {
            const code = document.getElementById('editor-textarea').value;
            const language = document.getElementById('language').value;
            const terminalContent = document.getElementById('terminal-content');
            // Call your backend API to submit the code and get the result
            // For now, we just display a placeholder message
            terminalContent.textContent = `Submitting code in ${language}...\n\nSubmission Result: \n`;
        });
    });
</script>
{% endblock %}
